"use strict";(self.webpackChunkmy_react_components=self.webpackChunkmy_react_components||[]).push([[74],{9074:function(e,n,t){t.r(n),t.d(n,{default:function(){return J}});var o=t(4165),a=t(3433),r=t(5861),c=t(9439),s=t(2791),l=t(8182),i=t(184);function u(e){var n=e.text,t=e.staus,o=(0,l.Z)("Not Intersted"===t&&"bg-red-300","Important"===t&&"bg-green-300","Normal"===t&&"bg-orange-300");return(0,i.jsx)("h6",{className:"px-1 py-2 rounded-full text-gray-600 text-center  "+o,children:n})}var d=t(790),m=t(4942),h=t(1413),p=t(1243),x=t(3786),g=t(5574),Z=t(5661),f=t(4554),y=t(68),j=t(3400),C=t(6151),b=t(7123),v=t(9157),w=t(1582),_=t(8820),T=t(5397),k=(t(8161),t(8096)),N=t(4925),K=t(8406);function S(e){var n=e.lable,t=e.keyValue,o=e.values,a=e.setValues,r=e.choisesArray;return(0,i.jsxs)(k.Z,{children:[(0,i.jsx)(N.Z,{id:"demo-select-small-label",children:n}),(0,i.jsx)(K.Z,{lable:n,value:o[t]||"",onChange:function(e){console.log(e.target.name),a((0,h.Z)((0,h.Z)({},o),{},(0,m.Z)({},e.target.name,e.target.value)))},inputProps:{name:t},children:r.map((function(e){return(0,i.jsx)(x.Z,{value:e[t],children:e[t]},e[t])}))})]})}var A=t(4750),E=t(1652),R=t(4544),V=t(7892),I=t.n(V);function D(e){var n=e.row,t=e.open,o=e.onClose,r=e.contactType,l=e.contactResult,u=(0,s.useState)(!0),m=(0,c.Z)(u,2),h=m[0],v=m[1],w=(0,s.useState)(!1),k=(0,c.Z)(w,2),N=k[0],K=k[1],S=(0,s.useState)([]),A=(0,c.Z)(S,2),E=A[0],R=A[1];(0,s.useEffect)((function(){p.Z.get(n.original.contact_url).then((function(e){R(e.data.results),v(!1)})).catch((function(e){console.log(e),R([]),v(!1)}))}),[]);var V=(0,s.useMemo)((function(){return[{accessorKey:"typ",header:"contact_type",muiTableBodyCellEditTextFieldProps:{select:!0,children:r.map((function(e){return(0,i.jsx)(x.Z,{defaultValue:"",value:e.contact_type,children:e.contact_type},e.contact_type)}))}},{accessorKey:"date",header:"date",filterFn:"lessThanOrEqualTo",sortingFn:"datetime"},{accessorKey:"result",header:"Result",muiTableBodyCellEditTextFieldProps:{select:!0,children:l.map((function(e){return(0,i.jsx)(x.Z,{defaultValue:"",value:e.contact_result,children:e.contact_result},e.contact_result)}))}}]}),[]),I=(0,s.useCallback)((function(e){window.confirm("Are you sure you want to delete ".concat(e.getValue("date")," contact")),console.log(e.original.contact_url),p.Z.delete(e.original.contact_url).then((function(e){console.log(e)})).catch((function(e){return console.log(e.response.data)})),E.splice(e.index,1),R((0,a.Z)(E))}),[E]);return n&&(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(g.Z,{fullWidth:!0,maxWidth:"md",sx:{p:1,width:"1500px",height:"100%"},open:t,onClose:o,children:[(0,i.jsxs)(Z.Z,{textAlign:"center",children:["Contact History of ",n.original.name]}),(0,i.jsxs)(f.Z,{className:"p-5",children:[(0,i.jsx)(d.ZP,{columns:V||[],data:E,state:{isLoading:h},enablePagination:!1,enableGlobalFilter:!1,enableDensityToggle:!1,enableGlobalFilterRankedResults:!1,enableEditing:!0,enableD:!0,onEditingRowSave:function(e){var n=e.exitEditingMode,t=e.row,o=e.values;E[t.index]=o,R((0,a.Z)(E));var r=t.original.contact_url,c={contact_type:o.typ,date:o.date,contact_result:o.result};console.log(c),p.Z.put(r,c).then((function(e){console.log(e)})).catch((function(e){return console.log(e)})),n()},onEditingRowCancel:function(){console.log("canceld")},renderRowActions:function(e){var n=e.row,t=e.table;return(0,i.jsxs)(f.Z,{sx:{display:"flex",gap:"1rem"},children:[(0,i.jsx)(y.Z,{arrow:!0,placement:"left",title:"Edit",children:(0,i.jsx)(j.Z,{onClick:function(){return t.setEditingRow(n)},children:(0,i.jsx)(_.Z,{})})}),(0,i.jsx)(y.Z,{arrow:!0,placement:"right",title:"Delete",children:(0,i.jsx)(j.Z,{color:"error",onClick:function(){return I(n)},children:(0,i.jsx)(T.Z,{})})})]})},renderTopToolbarCustomActions:function(){return(0,i.jsx)(C.Z,{color:"secondary",onClick:function(){return K(!0)},variant:"contained",children:"Add New Contact"})}}),(0,i.jsx)(F,{company_row:n,columns:V,open:N,onClose:function(){return K(!1)},onSubmit:function(e){E.push(e),R((0,a.Z)(E)),console.log(n)},contactType:r,contactResult:l})]}),(0,i.jsx)(b.Z,{sx:{p:"1.25rem"},children:(0,i.jsx)(C.Z,{onClick:o,children:"Close"})})]})})}var F=function(e){var n=e.open,t=e.columns,o=e.onClose,a=e.onSubmit,r=e.company_row,l=e.contactType,u=e.contactResult,d=(0,s.useState)((function(){return t.reduce((function(e,n){var t;return e[null!==(t=n.accessorKey)&&void 0!==t?t:""]="",e}),{})})),x=(0,c.Z)(d,2),f=x[0],y=x[1];return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(g.Z,{open:n,children:[(0,i.jsx)(Z.Z,{textAlign:"center",children:"Create New Account"}),(0,i.jsx)(v.Z,{children:(0,i.jsx)("form",{onSubmit:function(e){return e.preventDefault()},children:(0,i.jsxs)(w.Z,{sx:{width:"100%",minWidth:{xs:"300px",sm:"360px",md:"400px"},gap:"1.5rem"},children:[(0,i.jsx)(S,{lable:"Contact Type",keyValue:"contact_type",choisesArray:l,values:f,setValues:y}),(0,i.jsx)(E._,{dateAdapter:A.y,children:(0,i.jsx)(R.M,{defaultValue:I()(),label:"Date",onChange:function(e){console.log(I()().format("YYYY-MM-DD")),y((0,h.Z)((0,h.Z)({},f),{},(0,m.Z)({},"date","".concat(e.$y,"-").concat(e.$M+1,"-").concat(e.$D))))}})}),(0,i.jsx)(S,{lable:"Contact Result",keyValue:"contact_result",choisesArray:u,values:f,setValues:y})]})})}),(0,i.jsxs)(b.Z,{sx:{p:"1.25rem"},children:[(0,i.jsx)(C.Z,{onClick:o,children:"Cancel"}),(0,i.jsx)(C.Z,{color:"secondary",onClick:function(){console.log(f),""===f.date&&(f.date=I()().format("YYYY-MM-DD"));var e="company/"+r.original.id,n={contact_type:f.contact_type,date:f.date,contact_result:f.contact_result};p.Z.post("http://localhost:8000/api/companies/"+e,n).catch((function(e){return console.log(e.response.data)})),console.log(n),f.typ=f.contact_type,f.result=f.contact_result,a(f),o()},variant:"contained",children:"Create New Account"})]})]})})},M=t(9145),P=t(6788),z=t(7391),O=t(9644);function W(e){var n=e.options,t=e.setValues,o=e.values;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(O.Z,{getOptionLabel:function(e){return e.name},onChange:function(e,n){t((0,h.Z)((0,h.Z)({},o),{},(0,m.Z)({},"country",n.name))),console.log(n)},disablePortal:!0,className:"",options:n,renderInput:function(e){return(0,i.jsx)(z.Z,(0,h.Z)({label:"Country"},e))},renderOption:function(e,n){return(0,i.jsx)(f.Z,(0,h.Z)((0,h.Z)({component:"li"},e),{},{children:n.name}))}})})}var Y=t(4277),B=function(e){var n=e.open,t=e.columns,o=e.onClose,a=e.onSubmit,r=e.states,l=(0,Y.v9)((function(e){return e.user.access})),u=(0,s.useState)((function(){return t.reduce((function(e,n){var t;return e[null!==(t=n.accessorKey)&&void 0!==t?t:""]="",e}),{})})),d=(0,c.Z)(u,2),f=d[0],y=d[1],j=(0,s.useState)(""),_=(0,c.Z)(j,2),T=_[0],S=_[1];return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(g.Z,{open:n,children:[(0,i.jsx)(Z.Z,{textAlign:"center",children:"Create New Account"}),(0,i.jsx)(v.Z,{children:(0,i.jsx)("form",{onSubmit:function(e){return e.preventDefault()},children:(0,i.jsxs)(w.Z,{sx:{width:"100%",minWidth:{xs:"300px",sm:"360px",md:"400px"},gap:"1.5rem",padding:"10px"},children:[(0,i.jsxs)("h3",{className:"text-red-500",children:[" ","".concat(JSON.stringify(T))]}),(0,i.jsx)(z.Z,{label:t[0].header,name:t[0].accessorKey,onChange:function(e){return y((0,h.Z)((0,h.Z)({},f),{},(0,m.Z)({},e.target.name,e.target.value)))}},t[0].accessorKey),(0,i.jsx)(W,{options:r,setValues:y,values:f}),(0,i.jsxs)(k.Z,{children:[(0,i.jsx)(N.Z,{id:"demo-select-small-label",children:"Status"}),(0,i.jsx)(K.Z,{labelId:"demo-select-small-label",id:"demo-simple-select",lable:"status",value:f.status,onChange:function(e){console.log(e.target.name,e.target.value),y((0,h.Z)((0,h.Z)({},f),{},(0,m.Z)({},e.target.name,e.target.value)))},inputProps:{name:t[2].accessorKey},children:["Important","Not Intersted","Normal"].map((function(e){return(0,i.jsx)(x.Z,{value:e,children:e},e)}))})]}),(0,i.jsx)(z.Z,{label:t[5].header,name:t[5].accessorKey,onChange:function(e){return y((0,h.Z)((0,h.Z)({},f),{},(0,m.Z)({},e.target.name,e.target.value)))}},t[5].accessorKey),(0,i.jsx)(z.Z,{label:t[3].header,name:t[3].accessorKey,onChange:function(e){return y((0,h.Z)((0,h.Z)({},f),{},(0,m.Z)({},e.target.name,e.target.value)))}},t[3].accessorKey),(0,i.jsx)(z.Z,{label:t[4].header,name:t[4].accessorKey,onChange:function(e){return y((0,h.Z)((0,h.Z)({},f),{},(0,m.Z)({},e.target.name,e.target.value)))}},t[4].accessorKey),(0,i.jsx)(z.Z,{label:t[6].header,name:t[6].accessorKey,onChange:function(e){return y((0,h.Z)((0,h.Z)({},f),{},(0,m.Z)({},e.target.name,e.target.value)))}},t[6].accessorKey)]})})}),(0,i.jsxs)(b.Z,{sx:{p:"1.25rem"},children:[(0,i.jsx)(C.Z,{onClick:o,children:"Cancel"}),(0,i.jsx)(C.Z,{color:"secondary",onClick:function(){console.log(f);var e=Object.assign({},f);delete e.country_name,e.status="Important"==e.status||"Not Intersted"!=e.status&&null,console.log(e),p.Z.post("http://127.0.0.1:8000/api/companies/",e,{headers:{Authorization:"JWT ".concat(l)}}).then((function(e){console.log(e),o()})).catch((function(e){console.log(e.response.data),S(e.response.data)})),S(""),f.country_name=f.country,f.status=e.status,a(f)},variant:"contained",children:"Create New Account"})]})]})})};function J(e){var n=e.tableData,t=e.setTableData,l=e.states,m=e.contactType,h=e.contactResult,g=(0,s.useState)(!0),Z=(0,c.Z)(g,2),b=(Z[0],Z[1],(0,s.useState)(!1)),v=(0,c.Z)(b,2),w=v[0],k=v[1],N=(0,s.useState)(!1),K=(0,c.Z)(N,2),S=K[0],A=K[1],E=(0,s.useState)(),R=(0,c.Z)(E,2),V=R[0],I=R[1],F=(0,Y.v9)((function(e){return e.user.access})),z=(0,s.useState)({}),O=(0,c.Z)(z,2),W=O[0],J=O[1],H=function(){var e=(0,r.Z)((0,o.Z)().mark((function e(r){var c,s,l,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=r.exitEditingMode,s=r.row,l=r.values,Object.keys(W).length||(n[s.index]=l,l.website="",l.email="",console.log(l),(i=Object.assign({},l)).country=i.country_name,delete i.country_name,i.status="Important"==i.status||"Not Intersted"!=i.status&&null,p.Z.put(s.original.company_url,i,{headers:{Authorization:"JWT ".concat(F)}}).then((function(e){return console.log(e)})).catch((function(e){console.log(e.response.data)})),t((0,a.Z)(n)),c());case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),$=(0,s.useCallback)((function(e){window.confirm("Are you sure you want to delete ".concat(e.getValue("name")))&&(console.log(e.original),p.Z.delete(e.original.company_url,{headers:{Authorization:"JWT ".concat(F)}}).then((function(e){console.log(e)})),n.splice(e.index,1),t((0,a.Z)(n)))}),[n]),G=(0,s.useMemo)((function(){return[{accessorKey:"name",header:"Company Name",size:30,enableClickToCopy:!0},{accessorKey:"country_name",header:"Country",muiTableBodyCellEditTextFieldProps:{select:!0,children:l.map((function(e){return(0,i.jsx)(x.Z,{value:e.name,children:e.name},e.name)}))}},{accessorKey:"status",accessorFn:function(e){return!0===e.status?"Important":!1===e.status?"Not Intersted":"Normal"},header:"Status",size:17,Cell:function(e){var n=e.cell;e.column;return(0,i.jsx)(u,{text:n.getValue(),staus:n.getValue()})},muiTableBodyCellEditTextFieldProps:function(e){e.cell,e.column;var n=e.row;e.table;return{select:!0,value:1==n.original.status?"Important":0==n.original.status?"Not Intersted":"Normal",children:["Important","Not Intersted","Normal"].map((function(e){return(0,i.jsx)(x.Z,{value:e,children:e},e)}))}}},{accessorKey:"manager",header:"Manager",size:10},{accessorKey:"phone",header:"Phone",size:30,enableClickToCopy:!0,Cell:function(e){var n=e.cell;e.column;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{children:n.getValue()}),(0,i.jsx)("a",{href:"tel:".concat(n.getValue()),children:(0,i.jsx)(M.Z,{fontSize:"small",color:"success"})})]})}},{accessorKey:"email",header:"Email",size:30,enableClickToCopy:!0},{accessorKey:"website",header:"Website",size:30,enableClickToCopy:!0}]}),[l]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d.ZP,{editingMode:"modal",displayColumnDefOptions:{"mrt-row-actions":{muiTableHeadCellProps:{align:"center"},size:120}},columns:G||[],data:n||[],enableColumnOrdering:!0,enableEditing:!0,onEditingRowSave:H,onEditingRowCancel:function(){J({})},renderRowActions:function(e){var n=e.row,t=e.table;return(0,i.jsxs)(f.Z,{sx:{display:"flex",gap:"1rem"},children:[(0,i.jsx)(y.Z,{arrow:!0,placement:"left",title:"Edit",children:(0,i.jsx)(j.Z,{onClick:function(){return t.setEditingRow(n)},children:(0,i.jsx)(_.Z,{})})}),(0,i.jsx)(y.Z,{arrow:!0,placement:"right",title:"Delete",children:(0,i.jsx)(j.Z,{color:"error",onClick:function(){return $(n)},children:(0,i.jsx)(T.Z,{})})}),(0,i.jsx)(y.Z,{arrow:!0,placement:"right",title:"Contact History",children:(0,i.jsx)(j.Z,{color:"secondary",onClick:function(){return function(e){I(e),A(!0),console.log(e),console.log(V)}(n)},children:(0,i.jsx)(P.Z,{})})})]})},renderTopToolbarCustomActions:function(){return(0,i.jsx)(C.Z,{color:"secondary",onClick:function(){return k(!0)},variant:"contained",children:"Create New Account"})}}),S&&(0,i.jsx)(D,{contactType:m,contactResult:h,row:V,open:S,onClose:function(){return A(!1)}}),(0,i.jsx)(B,{columns:G,open:w,onClose:function(){return k(!1)},onSubmit:function(e){n.push(e),t((0,a.Z)(n))},states:l})]})}}}]);
//# sourceMappingURL=74.c0748552.chunk.js.map